# ASG одежда

В репозитории формируется бэкенд для магазина одежды с возможностью печати на ней принтов и вышивки.
Бэкенд представляет из себя модульный монолит. При необходимости возможно его разделение на
отдельные сервисы с выносом в отдельные репозитории.

При разработке проекта применяется подходы "сначала спецификация" и TDD.

## Зависимости проекта

* make - автоматизация управления проектом.
* docker-compose-plugin - запуск проекта и дополнительных сервисов в различных условиях.
* pyenv (https://github.com/pyenv/pyenv) - установка версии Python для проекта.

## Команды проекта

1. `make test` - Запуск тестов в контейнере.
2. `make run` - Запуск проекта в контейнере.

Остальные команды описаны в `Makefile`.

Проект разрабатывается таким образом, чтобы была возможность запуска тестов с использованием
инструментов из IDE.

## Управление миграциями базы данных

Команды:

1. `make init_db` - Инициализация папки с миграциями. Запускается при начале ведения проекта или при
   выходе на прод, чтобы не тащить миграции созданные в процессе разработки.
2. `make migrate_db` - Создание миграции при изменении схемы БД. Комментарий к новой миграции менять
   в Makefile и оставлять там, чтобы он попал в коммит.
3. `make upgrate_db` - Применении миграции при изменении схемы БД.

## Отправка TOTP

Для отправки TOTP необходим ключ шифрования. Ключ шифрования присваивается каждому пользователю
уникальный. При выходе пользователя из системы он меняется на новый.

## CI/CD

В проекте применяется CI/CD, процесс сформирован для раннеров Gitlab. На прод доставляются только те
изменения, которые прошли ревью и были приняты в `main`. Никакие незафиксированные в репозитории
изменения НЕ деплоятся.

## Служебные эндпоинты

* `GET /alive` - проверка, что приложение запущено.
* `GET /ready` - при вызове данного эндпоинта проверяется доступность внешних сервисов.
* `GET /collapse` - вызывает исключение для проверки работы системы обработки ошибок.
* `GET /docs` - SwaggerUI-интерфейс для спецификации API.
